---
title: Zigbee协议
date: 2022-05-06 14:31:53
tags:
    - 协议
---

<!--more-->

# Zigbee协议

## Zigbee协议简介

Zigebee是IEEE 802.15.4标准的低功耗局域网协议，是一种短距离、低功耗的无线通信技术，主要适合用于自动控制和远程控制领域，可以嵌入各种设备。

短距离最大通讯速度是255kb/s，相比于wifi和移动网络，它的传输速度是很低的,Zigbee主要用于传输一些控制命令以及一些传感器采集的数据等等，同时也是一个睡眠节点，可拓展性很强，在局域网中最大达到65535个节点。

## 节点类型

Zigbee拓扑有三种功能节点

- 协调器	Coordinator
- 路由器	Router
- 终端设备	End Device

![image-20220506144142206](https://s2.loli.net/2022/05/06/T1AoyfeMW5sKukU.png)

## Zigbee架构

![image-20220506144949964](https://s2.loli.net/2022/05/06/k8TKGtbBE1LfM9y.png)

在ZigBee 网络中，一共分为4层结构。 

1、物理层（PHY）：物理层定义了物理无线信道和MAC 子层之间的接口，提供物理层数据服务和物理层管理服务。­物理层数据服务从无线物理信道上收发数据。­物理管理服务维护一个由物理层相关数据组成的数据库。

2、MAC 层：MAC 层负责处理所有的物理无线信道访问，并产生网络信号、同步信号；支持PAN 连接和分离，提供两个对等MAC  实体之间可靠的链路。_MAC 层数据服务：保证MAC 协议数据单元在物理层数据服务中正确收发。MAC 层管理服务：维护一个存储MAC  子层协议状态相关信息的数据库。

3、网络层（NWK）：ZigBee  协议栈的核心部分在网络层。网络层主要实现节点加入或离开网络、接收或抛弃其他节点、路由查找及传送数据等功能，支持Cluster-Tree  等多种路由算法，支持星形（Star）、树形（Cluster-Tree）、网格（Mesh）等多种[拓扑结构](https://www.eefocus.com/baike/513966)。

4、应用层（APL）：ZigBee 应用层框架包括应用支持层(APS)、ZigBee 设备对象(ZDO)和制造商所定义的应用对象。应用支持层的功能包括：维持绑定表、在绑定的设备之间传送消息。所谓绑定就是基于两台设备的服务和需求将它们匹配地连接起来。

## 设备组网流程

组建一个完整的zigbee网状网络包括两个步骤：网络初始化、节点加入网络。其中节点加入网络又包括两个步骤：通过与协调器连接入网和通过已有父节点入网。

![image-20220506150215118](https://s2.loli.net/2022/05/06/lbdSga4Tzvr2NoJ.png)

### 节点通过协调器加入网络

![image-20220506153326349](https://s2.loli.net/2022/05/06/rgitz9lJsBqC4VN.png)  

##  ZigBee协议优缺点 

### **ZigBee协议的优点：**

1、低功耗：工作模式下，[ZigBee技术](https://www.eefocus.com/baike/510530)的传输速率低，传输数据量很小，因此信号的收发时间很短。其次，在非工作模式情况下，ZigBee的节点处于休眠状态。

2、低成本：通过大幅简化协议，降低了对节点存储和计算能力的要求。根据研究以8051的8位[微控制器](https://www.eefocus.com/baike/485598)测算，全功能设备需要32K的代码，精简功能只需要4KB的代码，而且ZigBee协议专利免费。

3、低速率：ZigBee工作在20-250kbit/s的较低速率，分别提供250kbit/s（2.4GHz）、40kbit/s（915MHz）和20kbit/s（868MHz）的原始数据吞吐率，能够满足低速率传输数据的应用要求。

4、近距离：ZigBe设备点对点的传输范围一般介于10-100米之间。在增加射频发射功率后，传输范围可增加到1-3km。如果通过路由和节点间的转发，传输距离可以更远。

5、短时延：ZigBee响应速度较快，一般从睡眠转入工作状态只需要15ms。节点连接进入网络只需30ms，进一步节省了电能。相比较蓝牙需要3-10秒，WIFI需要3秒。

6、网络容量大：ZigBee低速率、低功耗和短距离传输的特点使得它非常适宜支持简单器件。

7、高安全：ZigBee提供了数据完整性检查和鉴权功能。在数据传输过程中提供了三级安全性。

8、免执照频段：ZigBee设备物理层采用工业、科学、医疗（ISM）频段。

9、数据传输可靠：ZigBee的媒质传入控制层（MAC层）采用talk-when-ready的碰撞避免机制。在这种完全确认的数据传输机制下，当有数据传送需求时则立刻发送，发送的每个数据分组都必须等待接收方的确认消息，并进行确认信息回复。若没有得到确认信息的回复就表示发生了冲突，将重传一次。

### **ZigBee协议的缺点：**

1、成本：目前ZIGBEE芯片出货量比较大的TI公司，芯片其成本均在2~3美金左右，再考虑到其他外围器件和相关2.4G射频器件，成本难以低于10美金。

2、通信稳定性：目前国内Zigbee技术主要采用ISM频段中的2.5G频率，其衍射能力弱，穿墙能力弱。家居环境中，即使是一扇门，一扇窗，一堵非承重墙，也会让信号大打折扣。

3、自组网能力：Zigbee技术的主要特点是支持自组网能力强，自恢复能力强，因此，对于井下定位，停车场车位定位，室外温湿度采集，污染采集等应用非常具有吸引力。然而，对于智能家居的应用场景中，开关，插座，窗帘的位置一旦固定，一直不变，自组网的优点也就不复存在，但是自组网所耗费的时间和资源却依旧高昂。

